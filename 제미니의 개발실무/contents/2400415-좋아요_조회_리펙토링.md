
# 좋아요 조회 리펙토링 + 레이어/캐싱 전략 - [토이 프로젝트 쩌스트 백엔드]

> [유튜브](https://www.youtube.com/watch?v=woCvxz_mJCg)

좋아요 카운트 안에 좋아요 여부도 포함됨

- count -> status 로 변경

좋아요 상태 컨트롤러에서 카운트와 좋아요 여부 서비스 로직을 둘 다 호출 중

- 서비스 로직을 하나로 합침
  - status = count + isLiked
- 이거를 하나로 합친 순간 이 합친 것을 비즈니스로 보는 것
- '그러면 서비스 안에서 이 두개를 각각 조회할까, 둘을 합쳐서 구현으로 내릴까?' 를 고민해볼 수 있음
  - 고민 후, 지금은 합칠 필요 없어보임. 각각이 따로 필요할 경우가 있어보임.

캐싱에 대한 문제

- 캐싱은 어디든 바를 수 있음
- 좋아요 상태 api 는 컨트롤러에 바르면 안됨
  - 좋아요 개수는 괜찮지만, 유저별로 다른 좋아요 여부를 캐싱하면 안됨
  - 그런 의미로 현재 좋아요 상태는 서비스 로직으로 포함되었으니, 서비스 로직에서 캐싱을 하면 안됨
- 쭉쭉 내려가면서 캐싱을 고민하게 됨
- 데이터베이스 자체를 캐싱할 수도 있음
  - CachedLikeRepository
- 구현레이어를 잘 나눠서 캐싱하는 것을 선호하긴 함
- 어쩔땐 캐시된 것이 필요하고, 어쩔땐 원본이 필요하고, 해서 구분하는 것이 좋음
  - LikeReader, LikeReaderWithCache
